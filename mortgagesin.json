{"openapi":"3.1.0","info":{"title":"Mortgage Simulation API","description":"A comprehensive mortgage and savings simulation API","version":"1.0.0"},"paths":{"/":{"get":{"tags":["Health"],"summary":"Root","description":"Health check endpoint","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/simulate":{"post":{"tags":["Simulation"],"summary":"Simulate Mortgage Endpoint","description":"Run a complete mortgage and savings simulation\n\nThis endpoint performs a comprehensive simulation of mortgage payments, savings growth,\nand net worth over time based on the provided parameters.\n\n**Key Features:**\n- Fixed-rate period followed by variable rate\n- Overpayment handling with savings deduction\n- Savings growth with interest compounding\n- Payment constraints and feasibility checks\n- Net worth calculation including property value\n\n**Returns:**\n- Month-by-month detailed data\n- Summary statistics\n- Chart-ready data arrays\n- Warnings and validation messages","operationId":"simulate_mortgage_endpoint_simulate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SimulationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SimulationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/simulate/csv":{"post":{"tags":["Export"],"summary":"Export Simulation Csv","description":"Run simulation and return results as CSV file download\n\nThis endpoint runs the same simulation as /simulate but returns the results\nas a downloadable CSV file for further analysis in Excel or other tools.","operationId":"export_simulation_csv_simulate_csv_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SimulationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/simulate/sample":{"get":{"tags":["Examples"],"summary":"Get Sample Request","description":"Get a sample simulation request with realistic default values\n\nThis endpoint returns a properly formatted sample request that can be used\nas a starting point for customization or testing. The sample includes an\noverpayment schedule to demonstrate how overpayments work.","operationId":"get_sample_request_simulate_sample_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SimulationRequest"}}}}}}},"/overpayment-schedule/create":{"get":{"tags":["Utilities"],"summary":"Create Overpayment Schedule Endpoint","description":"Generate an overpayment schedule based on different patterns\n\n**Schedule Types:**\n- **none**: No overpayments\n- **fixed**: Fixed amount every month\n- **lump_sum**: Specific amounts in specific months\n- **yearly_bonus**: Same amount every year in specific month\n- **custom**: Custom schedule via lump_sums parameter\n\nReturns a string that can be used in the overpayments field of simulation requests.","operationId":"create_overpayment_schedule_endpoint_overpayment_schedule_create_get","parameters":[{"name":"term_months","in":"query","required":true,"schema":{"type":"integer","description":"Total mortgage term in months","title":"Term Months"},"description":"Total mortgage term in months"},{"name":"schedule_type","in":"query","required":true,"schema":{"type":"string","description":"Type of schedule: 'none', 'fixed', 'lump_sum', 'yearly_bonus', 'custom'","title":"Schedule Type"},"description":"Type of schedule: 'none', 'fixed', 'lump_sum', 'yearly_bonus', 'custom'"},{"name":"monthly_amount","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"description":"For 'fixed' type: monthly overpayment amount","title":"Monthly Amount"},"description":"For 'fixed' type: monthly overpayment amount"},{"name":"bonus_month","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"For 'yearly_bonus' type: month of year (1-12)","title":"Bonus Month"},"description":"For 'yearly_bonus' type: month of year (1-12)"},{"name":"bonus_amount","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"description":"For 'yearly_bonus' type: annual bonus amount","title":"Bonus Amount"},"description":"For 'yearly_bonus' type: annual bonus amount"},{"name":"lump_sums","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"For 'lump_sum' type: 'month:amount,month:amount' format","title":"Lump Sums"},"description":"For 'lump_sum' type: 'month:amount,month:amount' format"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ChartData":{"properties":{"years":{"items":{"type":"number"},"type":"array","title":"Years","description":"Year values for x-axis"},"mortgage_balance":{"items":{"type":"number"},"type":"array","title":"Mortgage Balance","description":"Mortgage balance over time"},"savings_balance":{"items":{"type":"number"},"type":"array","title":"Savings Balance","description":"Savings balance over time"},"net_worth":{"items":{"type":"number"},"type":"array","title":"Net Worth","description":"Net worth over time"},"monthly_payments":{"items":{"type":"number"},"type":"array","title":"Monthly Payments","description":"Monthly payments over time"},"interest_paid":{"items":{"type":"number"},"type":"array","title":"Interest Paid","description":"Monthly interest paid"},"principal_paid":{"items":{"type":"number"},"type":"array","title":"Principal Paid","description":"Monthly principal paid"},"monthly_savings_data":{"items":{"type":"number"},"type":"array","title":"Monthly Savings Data","description":"Monthly savings contributions"},"interest_received":{"items":{"type":"number"},"type":"array","title":"Interest Received","description":"Monthly interest received from savings"}},"type":"object","required":["years","mortgage_balance","savings_balance","net_worth","monthly_payments","interest_paid","principal_paid","monthly_savings_data","interest_received"],"title":"ChartData","description":"Aggregated data suitable for charting"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MonthlyData":{"properties":{"month":{"type":"integer","title":"Month","description":"1-based month number"},"year":{"type":"number","title":"Year","description":"Year as decimal (e.g., 1.5 for month 18)"},"principal_start":{"type":"number","title":"Principal Start","description":"Principal at start of month"},"principal_end":{"type":"number","title":"Principal End","description":"Principal at end of month"},"monthly_payment":{"type":"number","title":"Monthly Payment","description":"Base monthly payment"},"overpayment":{"type":"number","title":"Overpayment","description":"Any overpayment made"},"total_payment":{"type":"number","title":"Total Payment","description":"Monthly payment + overpayment"},"interest_paid":{"type":"number","title":"Interest Paid","description":"Interest portion of payment"},"principal_repaid":{"type":"number","title":"Principal Repaid","description":"Principal portion of payment"},"savings_balance_end":{"type":"number","title":"Savings Balance End","description":"Savings balance at end of month"},"savings_interest":{"type":"number","title":"Savings Interest","description":"Interest earned on savings"},"net_worth":{"type":"number","title":"Net Worth","description":"Savings - mortgage + asset value"},"annual_mortgage_rate":{"type":"number","title":"Annual Mortgage Rate","description":"Mortgage rate as percentage"},"monthly_interest_rate":{"type":"number","title":"Monthly Interest Rate","description":"Monthly mortgage rate as decimal"},"annual_savings_rate":{"type":"number","title":"Annual Savings Rate","description":"Savings rate as percentage"},"monthly_savings_rate":{"type":"number","title":"Monthly Savings Rate","description":"Monthly savings rate as decimal"},"payment_difference":{"type":"number","title":"Payment Difference","description":"Difference between typical payment and actual payment"}},"type":"object","required":["month","year","principal_start","principal_end","monthly_payment","overpayment","total_payment","interest_paid","principal_repaid","savings_balance_end","savings_interest","net_worth","annual_mortgage_rate","monthly_interest_rate","annual_savings_rate","monthly_savings_rate","payment_difference"],"title":"MonthlyData","description":"Data for a single month of the simulation"},"MortgageParameters":{"properties":{"amount":{"type":"number","exclusiveMinimum":0.0,"title":"Amount","description":"Initial mortgage amount in pounds"},"term_years":{"type":"number","maximum":40.0,"exclusiveMinimum":0.0,"title":"Term Years","description":"Mortgage term in years"},"fixed_rate":{"type":"number","maximum":15.0,"minimum":0.0,"title":"Fixed Rate","description":"Fixed interest rate as percentage (e.g., 1.65)"},"fixed_term_months":{"type":"integer","minimum":0.0,"title":"Fixed Term Months","description":"Fixed rate term in months"},"variable_rate":{"type":"number","maximum":15.0,"minimum":0.0,"title":"Variable Rate","description":"Variable rate after fixed term as percentage","default":6.0},"max_payment_after_fixed":{"anyOf":[{"type":"number","exclusiveMinimum":0.0},{"type":"null"}],"title":"Max Payment After Fixed","description":"Maximum monthly payment after fixed period"}},"type":"object","required":["amount","term_years","fixed_rate","fixed_term_months"],"title":"MortgageParameters","description":"Mortgage-related input parameters"},"SavingsParameters":{"properties":{"rate":{"type":"number","maximum":15.0,"minimum":0.0,"title":"Rate","description":"Annual savings interest rate as percentage","default":4.3},"monthly_contribution":{"type":"number","minimum":0.0,"title":"Monthly Contribution","description":"Monthly savings contribution in pounds","default":2500.0},"initial_balance":{"type":"number","minimum":0.0,"title":"Initial Balance","description":"Initial savings balance in pounds","default":170000.0}},"type":"object","title":"SavingsParameters","description":"Savings-related input parameters"},"SimulationParameters":{"properties":{"typical_payment":{"type":"number","minimum":0.0,"title":"Typical Payment","description":"Typical monthly payment - difference goes to savings if actual payment is lower","default":878.0},"asset_value":{"type":"number","minimum":0.0,"title":"Asset Value","description":"Property value in pounds","default":360000.0},"show_years_after_payoff":{"type":"integer","maximum":20.0,"minimum":0.0,"title":"Show Years After Payoff","description":"Years to show after mortgage is paid off","default":5},"overpayments":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Overpayments","description":"Overpayments in format 'month:amount,month:amount' (e.g., '18:20000,19:10000')"}},"type":"object","title":"SimulationParameters","description":"Additional simulation parameters"},"SimulationRequest":{"properties":{"mortgage":{"$ref":"#/components/schemas/MortgageParameters"},"savings":{"$ref":"#/components/schemas/SavingsParameters"},"simulation":{"$ref":"#/components/schemas/SimulationParameters","default":{"typical_payment":878.0,"asset_value":360000.0,"show_years_after_payoff":5}}},"type":"object","required":["mortgage","savings"],"title":"SimulationRequest","description":"Complete simulation request"},"SimulationResponse":{"properties":{"monthly_data":{"items":{"$ref":"#/components/schemas/MonthlyData"},"type":"array","title":"Monthly Data","description":"Month-by-month simulation data"},"summary_statistics":{"$ref":"#/components/schemas/SummaryStatistics","description":"Summary statistics"},"chart_data":{"$ref":"#/components/schemas/ChartData","description":"Data formatted for charting"},"warnings":{"items":{"type":"string"},"type":"array","title":"Warnings","description":"Any warnings or notes from the simulation"}},"type":"object","required":["monthly_data","summary_statistics","chart_data","warnings"],"title":"SimulationResponse","description":"Complete simulation response"},"SummaryStatistics":{"properties":{"final_mortgage_balance":{"type":"number","title":"Final Mortgage Balance","description":"Final mortgage balance"},"final_savings_balance":{"type":"number","title":"Final Savings Balance","description":"Final savings balance"},"final_net_worth":{"type":"number","title":"Final Net Worth","description":"Final net worth"},"min_savings_balance":{"type":"number","title":"Min Savings Balance","description":"Lowest savings balance during simulation"},"min_savings_month":{"type":"integer","title":"Min Savings Month","description":"Month when savings hit minimum"},"mortgage_paid_off_month":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Mortgage Paid Off Month","description":"Month when mortgage is paid off (if applicable)"},"fixed_term_end_balance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Fixed Term End Balance","description":"Balance at end of fixed term"}},"type":"object","required":["final_mortgage_balance","final_savings_balance","final_net_worth","min_savings_balance","min_savings_month"],"title":"SummaryStatistics","description":"Summary statistics from the simulation"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}